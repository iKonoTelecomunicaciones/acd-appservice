components:
  # Estructura de objetos
  schemas:
    Error:
      type: object
      properties:
        error:
          type: string

    Success:
      type: object
      properties:
        message:
          type: string

    UserCreatedSuccess:
      type: object
      properties:
        user_id:
          type: string
        control_room_id:
          type: string
        email:
          type: string

    QrOk:
      type: object
      properties:
        code:
          type: string
        timeout:
          type: integer

    MessageOk:
      type: object
      properties:
        event_id:
          type: string
        room_id:
          type: string
        sender:
          type: string
        receiver:
          type: string
        timestamp_send:
          type: integer
        timestamp_read:
          type: integer
        was_read:
          type: boolean

    ControlRoom:
      type: object
      properties:
        room_id:
          type: string

    LoginOk:
      type: object
      properties:
        jid:
          type: string
        phone:
          type: string
        success:
          type: boolean

    Pm:
      type: object
      properties:
        sender_id:
          type: string
        customer_phone:
          type: string
        room_id:
          type: string
        agent_displayname:
          type: string
        reply:
          type: string
        status:
          type: integer

    QrFail:
      type: object
      properties:
        success:
          type: boolean
        error:
          type: string
        errorcode:
          type: string

    LoginDataOk:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/LoginOk'
        status:
          type: integer
      example:
          data:
            jid: "573123456789.0:65@s.whatsapp.net"
            phone: "+573123456789"
            success: true
          status: 201

    QrDataOk:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/QrOk'
        status:
          type: integer
      example:
          data:
            code: "2@Y0SYKO62z8tZXp9KDf4w8D/4qLioopgFtT3Bc2aSdt6Jdmg4DZlM1..."
            timeout: 60
          status: 200

    MessageDataOk:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/MessageOk'
      example:
          event_id: "$viRb6Wrnt2_25VbfjGhT-MVS9M2V52ILe6Pe-KTr4C4"
          room_id: "!JkbrMXRBOmnqacLMep:darknet"
          sender: "@acd_1:darknet"
          receiver: "+573123456789"
          timestamp_send: 1654877677916
          timestamp_read: 1654877699166
          was_read: true

    ControlRoomDataOk:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/ControlRoom'
      example:
          room_id: "!JkbrMXRBOmnqacLMep:darknet"

    QrDataFail:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/QrFail'
        status:
          type: integer
      example:
          data:
            success: false
            error: "QR code scan timed out. Please try again."
            errcode: "login timed out"
          status: 422

    PmOk:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/Pm'
        status:
          type: integer
      example:
          sender_id: "@agente1:darknet"
          customer_phone: "+573123456789"
          company_phone: "+57398765432"
          room_id: "!jIqZOpixKgUIplraWg:darknet"
          agent_displayname: "agente1"
          reply: "You are already in room with [number], message was sent."
          status: 200

    PmFail:
      type: object
      properties:
        data:
          $ref: '#/components/schemas/Pm'
        status:
          type: integer
      example:
          sender_id: "@agente1:darknet"
          phone_number: "+57305879"
          room_id: null
          agent_displayname: null
          reply: "The server said [number] is not on WhatsApp"
          status: 422

    SendMessageSuccessful:
      type: object
      properties:
        detail:
          type: string
        event_id:
          type: string
        room_id:
          type: string
      example:
        detail: "The message has been sent (probably)"
        event_id: "$PHtug6AByEXtMcJR-TvZ9lR6DgixA9nvyPNroyppSV8"
        room_id: "!CzCDxtfIpIshzruJBR:darknet"

    BridgesStatusSuccessful:
      type: object
      properties:
        bridge_status:
          type: array
          items:
            type: object
            properties:
              admin:
                type: boolean
              mxid:
                type: string
              relay_whitelisted:
                type: boolean
              whatsapp:
                type: object
                properties:
                  conn:
                    type: object
                    properties:
                      is_connected:
                        type: boolean
                      is_logged_in:
                        type: boolean
                  device:
                    type: integer
                  has_session:
                    type: boolean
                  jid:
                    type: string
                  management_room:
                    type: string
                  phone:
                    type: string
                  platform:
                    type: string
              whitelisted:
                    type: boolean
      example:
        bridges_status:
          - admin: true
            mxid: "@acd1:darknet"
            relay_whitelisted: true
            whatsapp:
              conn:
                is_connected: true
                is_logged_in: true
              device: 49
              has_session: true
              jid: 5730000000.0:49@s.whatsapp.net
              management_room: "!qygKFQLVCpfPLjEWqc:darknet"
              phone: "+5730000000"
              platform: smba
            whitelisted: true
          - admin: true
            mxid: "@acd2:darknet"
            relay_whitelisted: true
            whatsapp:
              conn:
                is_connected: true
                is_logged_in: true
              device: 25
              has_session: true
              jid: 573001290000.0:25@s.whatsapp.net
              management_room: "!pCJFIiZUmWnuigitTT:darknet"
              phone: "+573001290000"
              platform: smba
            whitelisted: true

  # Respuestas de la API
  responses:
    UserCreated:
      description: User has been created.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/UserCreatedSuccess'

    PmSuccessful:
      description: Pm successful.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/PmOk'

    QrGenerated:
      description: QR has been generated.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/QrDataOk'

    MessageFound:
      description: QR has been generated.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/MessageDataOk'

    ControlRoomFound:
      description: ControlRoom.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ControlRoomDataOk'

    LoginSuccessful:
      description: QR has been generated.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/LoginDataOk'

    QrNoGenerated:
      description: QR has not been generated.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/QrDataFail'

    OK:
      description: The request was successful..
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Success'

    SendMessage:
      description: The message has been sent
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SendMessageSuccessful'

    BadRequest:
      description: Could not interpret the request due to invalid syntax.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    ErrorData:
      description: The request was well formed but could not be followed due to semantic errors.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    NotExist:
      description: User doesn't exist.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    NotSendMessage:
      description: Not send message.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/PmFail'

    TooManyRequests:
      description: You already have a pending request.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    BridgesStatus:
      description: Bridges status.
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BridgesStatusSuccessful'
